<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="theme-color" content="#e85d04">
  <title>íšŒì›ê°€ì… â€” CodeDuck</title>
  <meta name="description" content="ì½”ë“œë•ì¿  íšŒì›ê°€ì…. ì´ë©”ì¼ ì¸ì¦ í›„ ìŒì•… ì»¤ë®¤ë‹ˆí‹°ì— ì°¸ì—¬í•˜ì„¸ìš”.">
  <meta name="robots" content="noindex, nofollow">

  <!-- Favicon -->
  <link rel="icon" href="images/og-thumbnail.png">

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">

  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --orange:    #e85d04;
      --orange-dk: #c24e03;
      --bg:        #f8f9fa;
      --bg-card:   #ffffff;
      --border:    #e5e7eb;
      --text:      #1a1a2e;
      --text-sub:  #6b7280;
      --radius:    14px;
      --shadow:    0 2px 12px rgba(0,0,0,.08);
    }

    body {
      font-family: 'Noto Sans KR', 'Inter', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* â”€â”€ í—¤ë” â”€â”€ */
    .auth-header {
      background: #fff;
      border-bottom: 1px solid var(--border);
      padding: 14px 24px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .auth-header .logo-link {
      display: flex; align-items: center; gap: 8px;
      text-decoration: none;
    }
    .auth-header .logo-icon { font-size: 1.5rem; }
    .auth-header .logo-text {
      font-size: 1.2rem; font-weight: 900; color: var(--text);
      letter-spacing: -0.5px;
    }
    .auth-header .logo-text span { color: var(--orange); }

    /* â”€â”€ ë©”ì¸ ì»¨í…Œì´ë„ˆ â”€â”€ */
    .auth-main {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 16px;
    }

    .auth-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      width: 100%;
      max-width: 520px;
      padding: 40px 36px;
    }

    .auth-card-title {
      font-size: 1.55rem;
      font-weight: 900;
      margin-bottom: 6px;
      letter-spacing: -0.5px;
    }
    .auth-card-sub {
      font-size: 0.9rem;
      color: var(--text-sub);
      margin-bottom: 32px;
      line-height: 1.6;
    }

    /* â”€â”€ í¼ ê³µí†µ â”€â”€ */
    .form-group {
      margin-bottom: 20px;
    }
    .form-label {
      display: block;
      font-size: 0.88rem;
      font-weight: 700;
      margin-bottom: 7px;
      color: var(--text);
    }
    .form-label .required {
      color: var(--orange);
      margin-left: 3px;
    }
    .form-label .optional {
      font-size: 0.78rem;
      font-weight: 400;
      color: var(--text-sub);
      margin-left: 4px;
    }
    .form-input {
      width: 100%;
      padding: 11px 14px;
      border: 1.5px solid var(--border);
      border-radius: 10px;
      font-size: 0.95rem;
      font-family: inherit;
      color: var(--text);
      background: #fafafa;
      transition: border-color .18s, box-shadow .18s;
      outline: none;
    }
    .form-input:focus {
      border-color: var(--orange);
      box-shadow: 0 0 0 3px rgba(232,93,4,.12);
      background: #fff;
    }
    .form-input.error { border-color: #ef4444; }
    .form-hint {
      font-size: 0.78rem;
      color: var(--text-sub);
      margin-top: 5px;
    }
    .form-error {
      font-size: 0.8rem;
      color: #ef4444;
      margin-top: 5px;
      display: none;
    }
    .form-error.show { display: block; }

    /* â”€â”€ ì„±ë³„ ë¼ë””ì˜¤ â”€â”€ */
    .gender-group {
      display: flex;
      gap: 10px;
    }
    .gender-option {
      flex: 1;
      position: relative;
    }
    .gender-option input[type=radio] {
      position: absolute; opacity: 0; width: 0; height: 0;
    }
    .gender-option label {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 10px 12px;
      border: 1.5px solid var(--border);
      border-radius: 10px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 500;
      transition: all .18s;
      background: #fafafa;
      user-select: none;
    }
    .gender-option input:checked + label {
      border-color: var(--orange);
      background: #fff7f0;
      color: var(--orange);
      font-weight: 700;
    }
    .gender-option label:hover { border-color: #fdba74; background: #fff7f0; }

    /* â”€â”€ íŒŒíŠ¸ ì²´í¬ë°•ìŠ¤ â”€â”€ */
    .parts-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
    }
    @media (max-width: 400px) {
      .parts-grid { grid-template-columns: repeat(2, 1fr); }
    }
    .part-option {
      position: relative;
    }
    .part-option input[type=checkbox] {
      position: absolute; opacity: 0; width: 0; height: 0;
    }
    .part-option label {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 9px 12px;
      border: 1.5px solid var(--border);
      border-radius: 9px;
      cursor: pointer;
      font-size: 0.85rem;
      font-weight: 500;
      transition: all .18s;
      background: #fafafa;
      user-select: none;
    }
    .part-option input:checked + label {
      border-color: var(--orange);
      background: #fff7f0;
      color: var(--orange);
      font-weight: 700;
    }
    .part-option label:hover { border-color: #fdba74; background: #fff7f0; }
    .part-option label .part-icon { font-size: 1rem; }

    /* â”€â”€ ê²½ë ¥ select â”€â”€ */
    .form-select {
      width: 100%;
      padding: 11px 14px;
      border: 1.5px solid var(--border);
      border-radius: 10px;
      font-size: 0.95rem;
      font-family: inherit;
      color: var(--text);
      background: #fafafa;
      transition: border-color .18s;
      outline: none;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      padding-right: 38px;
    }
    .form-select:focus {
      border-color: var(--orange);
      box-shadow: 0 0 0 3px rgba(232,93,4,.12);
    }

    /* â”€â”€ ë¹„ë°€ë²ˆí˜¸ ê°•ë„ â”€â”€ */
    .pw-strength {
      display: flex;
      gap: 4px;
      margin-top: 7px;
    }
    .pw-bar {
      flex: 1; height: 4px; border-radius: 4px;
      background: var(--border);
      transition: background .3s;
    }
    .pw-bar.weak   { background: #ef4444; }
    .pw-bar.medium { background: #f59e0b; }
    .pw-bar.strong { background: #10b981; }
    .pw-strength-text {
      font-size: 0.75rem;
      color: var(--text-sub);
      margin-top: 4px;
    }

    /* â”€â”€ êµ¬ë¶„ì„  â”€â”€ */
    .form-divider {
      border: none;
      border-top: 1px solid var(--border);
      margin: 24px 0;
    }

    /* â”€â”€ ì œì¶œ ë²„íŠ¼ â”€â”€ */
    .btn-submit {
      width: 100%;
      padding: 14px;
      background: var(--orange);
      color: #fff;
      border: none;
      border-radius: 11px;
      font-size: 1rem;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      transition: background .18s, transform .12s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .btn-submit:hover { background: var(--orange-dk); transform: translateY(-1px); }
    .btn-submit:active { transform: translateY(0); }
    .btn-submit:disabled { background: #fdba74; cursor: not-allowed; transform: none; }

    /* â”€â”€ í•˜ë‹¨ ë§í¬ â”€â”€ */
    .auth-footer-link {
      text-align: center;
      margin-top: 20px;
      font-size: 0.88rem;
      color: var(--text-sub);
    }
    .auth-footer-link a {
      color: var(--orange);
      font-weight: 700;
      text-decoration: none;
    }
    .auth-footer-link a:hover { text-decoration: underline; }

    /* â”€â”€ ì„±ê³µ ìƒíƒœ â”€â”€ */
    .success-box {
      display: none;
      text-align: center;
      padding: 20px 0;
    }
    .success-box.show { display: block; }
    .success-icon {
      font-size: 3.5rem;
      margin-bottom: 16px;
    }
    .success-title {
      font-size: 1.3rem;
      font-weight: 900;
      margin-bottom: 10px;
    }
    .success-desc {
      font-size: 0.9rem;
      color: var(--text-sub);
      line-height: 1.7;
      margin-bottom: 24px;
    }
    .success-desc strong { color: var(--orange); }
    .btn-go-login {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 12px 28px;
      background: var(--orange);
      color: #fff;
      border-radius: 10px;
      text-decoration: none;
      font-weight: 700;
      font-size: 0.95rem;
      transition: background .18s;
    }
    .btn-go-login:hover { background: var(--orange-dk); }

    /* â”€â”€ ê¸€ë¡œë²Œ ì—ëŸ¬ â”€â”€ */
    .global-error {
      background: #fef2f2;
      border: 1px solid #fca5a5;
      border-radius: 10px;
      padding: 12px 16px;
      font-size: 0.88rem;
      color: #dc2626;
      margin-bottom: 20px;
      display: none;
    }
    .global-error.show { display: block; }

    /* â”€â”€ ë¡œë”© ìŠ¤í”¼ë„ˆ â”€â”€ */
    .spinner {
      width: 18px; height: 18px;
      border: 2.5px solid rgba(255,255,255,.4);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin .7s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* â”€â”€ ì•½ê´€ ë™ì˜ â”€â”€ */
    .terms-check {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      font-size: 0.85rem;
      color: var(--text-sub);
      margin-bottom: 18px;
    }
    .terms-check input { margin-top: 2px; accent-color: var(--orange); }
    .terms-check a { color: var(--orange); text-decoration: none; }
    .terms-check a:hover { text-decoration: underline; }
  </style>
</head>
<body>

  <!-- í—¤ë” -->
  <header class="auth-header">
    <a href="index.html" class="logo-link" aria-label="ì½”ë“œë•ì¿  í™ˆìœ¼ë¡œ">
      <span class="logo-icon">ğŸ¦†</span>
      <span class="logo-text">Code<span>ducku</span></span>
    </a>
  </header>

  <!-- ë©”ì¸ -->
  <main class="auth-main">
    <div class="auth-card">

      <!-- íƒ€ì´í‹€ -->
      <h1 class="auth-card-title">ğŸ¸ íšŒì›ê°€ì…</h1>
      <p class="auth-card-sub">
        ì´ë©”ì¼ë¡œ ê°„ë‹¨íˆ ê°€ì…í•˜ê³ <br>
        ë®¤ì§€ì…˜ ì»¤ë®¤ë‹ˆí‹°ì— ì°¸ì—¬í•˜ì„¸ìš”!
      </p>

      <!-- ì„±ê³µ í™”ë©´ -->
      <div class="success-box" id="successBox">
        <div class="success-icon">âœ‰ï¸</div>
        <div class="success-title">ì¸ì¦ ë©”ì¼ì„ ë³´ëƒˆì–´ìš”!</div>
        <p class="success-desc">
          <strong id="successEmail"></strong> ë¡œ ì¸ì¦ ë§í¬ë¥¼ ë°œì†¡í–ˆìŠµë‹ˆë‹¤.<br>
          ë©”ì¼í•¨ì„ í™•ì¸í•˜ê³  ë§í¬ë¥¼ í´ë¦­í•˜ë©´ ê°€ì…ì´ ì™„ë£Œë¼ìš”.<br><br>
          <small>ë©”ì¼ì´ ì•ˆ ë³´ì´ë©´ ìŠ¤íŒ¸í•¨ì„ í™•ì¸í•´ë³´ì„¸ìš”.</small>
        </p>
        <a href="login.html" class="btn-go-login">
          <i class="fas fa-sign-in-alt"></i> ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ
        </a>
      </div>

      <!-- ê°€ì… í¼ -->
      <form id="signupForm" novalidate>

        <!-- ê¸€ë¡œë²Œ ì—ëŸ¬ -->
        <div class="global-error" id="globalError"></div>

        <!-- ì´ë©”ì¼ -->
        <div class="form-group">
          <label class="form-label" for="email">
            ì´ë©”ì¼ <span class="required">*</span>
          </label>
          <input type="email" id="email" class="form-input"
                 placeholder="example@email.com" autocomplete="email" required>
          <div class="form-error" id="emailError">ì˜¬ë°”ë¥¸ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
        </div>

        <!-- ë¹„ë°€ë²ˆí˜¸ -->
        <div class="form-group">
          <label class="form-label" for="password">
            ë¹„ë°€ë²ˆí˜¸ <span class="required">*</span>
          </label>
          <input type="password" id="password" class="form-input"
                 placeholder="8ì ì´ìƒ, ì˜ë¬¸+ìˆ«ì ì¡°í•©" autocomplete="new-password" required>
          <div class="pw-strength" id="pwStrength">
            <div class="pw-bar" id="bar1"></div>
            <div class="pw-bar" id="bar2"></div>
            <div class="pw-bar" id="bar3"></div>
          </div>
          <div class="pw-strength-text" id="pwStrengthText"></div>
          <div class="form-error" id="passwordError">8ì ì´ìƒ, ì˜ë¬¸+ìˆ«ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.</div>
        </div>

        <!-- ë¹„ë°€ë²ˆí˜¸ í™•ì¸ -->
        <div class="form-group">
          <label class="form-label" for="passwordConfirm">
            ë¹„ë°€ë²ˆí˜¸ í™•ì¸ <span class="required">*</span>
          </label>
          <input type="password" id="passwordConfirm" class="form-input"
                 placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ í•œ ë²ˆ ë” ì…ë ¥í•´ì£¼ì„¸ìš”" autocomplete="new-password" required>
          <div class="form-error" id="confirmError">ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>
        </div>

        <!-- ë‹‰ë„¤ì„ -->
        <div class="form-group">
          <label class="form-label" for="nickname">
            ë‹‰ë„¤ì„ <span class="required">*</span>
          </label>
          <input type="text" id="nickname" class="form-input"
                 placeholder="ì»¤ë®¤ë‹ˆí‹°ì—ì„œ ì‚¬ìš©í•  ë‹‰ë„¤ì„" maxlength="20" required>
          <div class="form-hint">2~20ì, í•œê¸€/ì˜ë¬¸/ìˆ«ì ì‚¬ìš© ê°€ëŠ¥</div>
          <div class="form-error" id="nicknameError">ë‹‰ë„¤ì„ì€ 2~20ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
        </div>

        <hr class="form-divider">

        <!-- ì„±ë³„ -->
        <div class="form-group">
          <label class="form-label">
            ì„±ë³„ <span class="required">*</span>
          </label>
          <div class="gender-group">
            <div class="gender-option">
              <input type="radio" id="genderMale" name="gender" value="male">
              <label for="genderMale"><span>â™‚</span> ë‚¨ì„±</label>
            </div>
            <div class="gender-option">
              <input type="radio" id="genderFemale" name="gender" value="female">
              <label for="genderFemale"><span>â™€</span> ì—¬ì„±</label>
            </div>
            <div class="gender-option">
              <input type="radio" id="genderOther" name="gender" value="other">
              <label for="genderOther"><span>â—</span> ê¸°íƒ€</label>
            </div>
          </div>
          <div class="form-error" id="genderError">ì„±ë³„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</div>
        </div>

        <!-- íŒŒíŠ¸ (ì¤‘ë³µ ì„ íƒ ê°€ëŠ¥) -->
        <div class="form-group">
          <label class="form-label">
            ë‚˜ì˜ íŒŒíŠ¸ <span class="required">*</span>
            <span class="optional">(ì¤‘ë³µ ì„ íƒ ê°€ëŠ¥)</span>
          </label>
          <div class="parts-grid">
            <div class="part-option">
              <input type="checkbox" id="partVocal" name="parts" value="vocal">
              <label for="partVocal"><span class="part-icon">ğŸ¤</span> ë³´ì»¬</label>
            </div>
            <div class="part-option">
              <input type="checkbox" id="partGuitar" name="parts" value="guitar">
              <label for="partGuitar"><span class="part-icon">ğŸ¸</span> ê¸°íƒ€</label>
            </div>
            <div class="part-option">
              <input type="checkbox" id="partBass" name="parts" value="bass">
              <label for="partBass"><span class="part-icon">ğŸµ</span> ë² ì´ìŠ¤</label>
            </div>
            <div class="part-option">
              <input type="checkbox" id="partKeyboard" name="parts" value="keyboard">
              <label for="partKeyboard"><span class="part-icon">ğŸ¹</span> í‚¤ë³´ë“œ</label>
            </div>
            <div class="part-option">
              <input type="checkbox" id="partDrums" name="parts" value="drums">
              <label for="partDrums"><span class="part-icon">ğŸ¥</span> ë“œëŸ¼</label>
            </div>
            <div class="part-option">
              <input type="checkbox" id="partDJ" name="parts" value="dj">
              <label for="partDJ"><span class="part-icon">ğŸ§</span> DJ</label>
            </div>
            <div class="part-option">
              <input type="checkbox" id="partViolin" name="parts" value="violin">
              <label for="partViolin"><span class="part-icon">ğŸ»</span> ë°”ì´ì˜¬ë¦°</label>
            </div>
            <div class="part-option">
              <input type="checkbox" id="partFlute" name="parts" value="flute">
              <label for="partFlute"><span class="part-icon">ğŸ¶</span> í”Œë£¨íŠ¸</label>
            </div>
            <div class="part-option">
              <input type="checkbox" id="partOther" name="parts" value="other">
              <label for="partOther"><span class="part-icon">ğŸ¼</span> ê¸°íƒ€ì•…ê¸°</label>
            </div>
          </div>
          <div class="form-error" id="partsError">íŒŒíŠ¸ë¥¼ í•˜ë‚˜ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.</div>
        </div>

        <!-- ìŒì•… ê²½ë ¥ (ì„ íƒ) -->
        <div class="form-group">
          <label class="form-label" for="career">
            ìŒì•… ê²½ë ¥
            <span class="optional">(ì„ íƒ)</span>
          </label>
          <select id="career" class="form-select">
            <option value="">ê²½ë ¥ì„ ì„ íƒí•´ì£¼ì„¸ìš”</option>
            <option value="beginner">ì…ë¬¸ (1ë…„ ë¯¸ë§Œ)</option>
            <option value="junior">ì´ˆê¸‰ (1~3ë…„)</option>
            <option value="intermediate">ì¤‘ê¸‰ (3~5ë…„)</option>
            <option value="senior">ê³ ê¸‰ (5~10ë…„)</option>
            <option value="expert">ì „ë¬¸ê°€ (10ë…„ ì´ìƒ)</option>
          </select>
        </div>

        <hr class="form-divider">

        <!-- ì•½ê´€ ë™ì˜ -->
        <div class="terms-check">
          <input type="checkbox" id="termsAgree">
          <label for="termsAgree">
            <a href="#" onclick="return false">ì´ìš©ì•½ê´€</a> ë° 
            <a href="#" onclick="return false">ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨</a>ì— ë™ì˜í•©ë‹ˆë‹¤. <span style="color:#e85d04">*</span>
          </label>
        </div>
        <div class="form-error" id="termsError">ì´ìš©ì•½ê´€ì— ë™ì˜í•´ì£¼ì„¸ìš”.</div>

        <!-- ì œì¶œ -->
        <button type="submit" class="btn-submit" id="submitBtn">
          <i class="fas fa-user-plus"></i>
          <span id="submitText">ì´ë©”ì¼ ì¸ì¦ í›„ ê°€ì…í•˜ê¸°</span>
        </button>

      </form>

      <div class="auth-footer-link">
        ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”? <a href="login.html">ë¡œê·¸ì¸</a>
      </div>

    </div>
  </main>

  <!-- Supabase JS v2 -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <script src="js/auth.js"></script>
  <script>
    // â”€â”€ ë¹„ë°€ë²ˆí˜¸ ê°•ë„ ì²´í¬ â”€â”€
    const pwInput = document.getElementById('password');
    pwInput.addEventListener('input', () => {
      const val = pwInput.value;
      const bar1 = document.getElementById('bar1');
      const bar2 = document.getElementById('bar2');
      const bar3 = document.getElementById('bar3');
      const txt  = document.getElementById('pwStrengthText');

      bar1.className = 'pw-bar'; bar2.className = 'pw-bar'; bar3.className = 'pw-bar';
      if (!val) { txt.textContent = ''; return; }

      let score = 0;
      if (val.length >= 8) score++;
      if (/[a-zA-Z]/.test(val) && /\d/.test(val)) score++;
      if (/[^a-zA-Z0-9]/.test(val)) score++;

      if (score === 1) {
        bar1.classList.add('weak');
        txt.textContent = 'âš ï¸ ì·¨ì•½í•œ ë¹„ë°€ë²ˆí˜¸';
        txt.style.color = '#ef4444';
      } else if (score === 2) {
        bar1.classList.add('medium'); bar2.classList.add('medium');
        txt.textContent = 'ğŸ”¶ ë³´í†µ ê°•ë„';
        txt.style.color = '#f59e0b';
      } else if (score === 3) {
        bar1.classList.add('strong'); bar2.classList.add('strong'); bar3.classList.add('strong');
        txt.textContent = 'âœ… ê°•í•œ ë¹„ë°€ë²ˆí˜¸';
        txt.style.color = '#10b981';
      }
    });

    // â”€â”€ í¼ ì œì¶œ â”€â”€
    document.getElementById('signupForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      // ê°’ ìˆ˜ì§‘
      const email    = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;
      const confirm  = document.getElementById('passwordConfirm').value;
      const nickname = document.getElementById('nickname').value.trim();
      const gender   = document.querySelector('input[name="gender"]:checked')?.value || '';
      const parts    = [...document.querySelectorAll('input[name="parts"]:checked')].map(c => c.value);
      const career   = document.getElementById('career').value;
      const terms    = document.getElementById('termsAgree').checked;

      // ì—ëŸ¬ ì´ˆê¸°í™”
      document.querySelectorAll('.form-error').forEach(el => el.classList.remove('show'));
      document.querySelectorAll('.form-input, .form-select').forEach(el => el.classList.remove('error'));
      const globalErr = document.getElementById('globalError');
      globalErr.classList.remove('show');

      let valid = true;

      // ìœ íš¨ì„± ê²€ì‚¬
      const emailReg = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailReg.test(email)) {
        showErr('emailError', 'email'); valid = false;
      }
      if (password.length < 8 || !/[a-zA-Z]/.test(password) || !/\d/.test(password)) {
        showErr('passwordError', 'password'); valid = false;
      }
      if (password !== confirm) {
        showErr('confirmError', 'passwordConfirm'); valid = false;
      }
      if (nickname.length < 2 || nickname.length > 20) {
        showErr('nicknameError', 'nickname'); valid = false;
      }
      if (!gender) {
        document.getElementById('genderError').classList.add('show'); valid = false;
      }
      if (parts.length === 0) {
        document.getElementById('partsError').classList.add('show'); valid = false;
      }
      if (!terms) {
        document.getElementById('termsError').classList.add('show'); valid = false;
      }

      if (!valid) return;

      // ë¡œë”© ìƒíƒœ
      const btn  = document.getElementById('submitBtn');
      const txt  = document.getElementById('submitText');
      btn.disabled = true;
      txt.innerHTML = '';
      btn.innerHTML = '<div class="spinner"></div> ì²˜ë¦¬ ì¤‘...';

      try {
        const { data, error } = await signUp({ email, password, nickname, gender, parts, career });

        if (error) {
          let msg = error.message || 'ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
          if (msg.includes('already registered') || msg.includes('already been registered')) {
            msg = 'ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤. ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ì„¸ìš”.';
          } else if (msg.includes('Password should')) {
            msg = 'ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒ, ì˜ë¬¸+ìˆ«ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.';
          } else if (msg.includes('rate limit')) {
            msg = 'ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”. (ìš”ì²­ì´ ë„ˆë¬´ ë§ìŠµë‹ˆë‹¤)';
          }
          globalErr.textContent = 'âŒ ' + msg;
          globalErr.classList.add('show');
          btn.disabled = false;
          btn.innerHTML = '<i class="fas fa-user-plus"></i> <span>ì´ë©”ì¼ ì¸ì¦ í›„ ê°€ì…í•˜ê¸°</span>';
        } else {
          // ì„±ê³µ: ì¸ì¦ ë©”ì¼ ë°œì†¡ë¨
          document.getElementById('signupForm').style.display = 'none';
          document.querySelector('.auth-footer-link').style.display = 'none';
          document.getElementById('successEmail').textContent = email;
          document.getElementById('successBox').classList.add('show');
        }
      } catch (err) {
        console.error('[Signup] ì˜¤ë¥˜:', err);
        globalErr.textContent = 'âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
        globalErr.classList.add('show');
        btn.disabled = false;
        btn.innerHTML = '<i class="fas fa-user-plus"></i> <span>ì´ë©”ì¼ ì¸ì¦ í›„ ê°€ì…í•˜ê¸°</span>';
      }
    });

    function showErr(errId, inputId) {
      document.getElementById(errId).classList.add('show');
      const el = document.getElementById(inputId);
      if (el) el.classList.add('error');
    }
  </script>
</body>
</html>
